<?xml version="1.0" encoding="UTF-8"?>
<project name="cobertura-tasks" default="test-with-coverage" basedir=".">

<!-- Code Coverage tastks for Jenkins -->
    <property name="cobertura.dir" value="/usr/share/java" />

    <path id="cobertura.classpath">
        <fileset dir="${cobertura.dir}">
            <include name="cobertura.jar" />
            <include name="lib/**/*.jar" />
        </fileset>
    </path>

    <taskdef classpathref="cobertura.classpath" resource="tasks.properties" />
    
    <target name="test-with-coverage" 
    depends="init,compile,compile-test,cobertura-instrument,-do-test-run,cobertura-report"/>

    <target name="cobertura-instrument" >
        <delete file="build/coverage/cobertura.ser" />
        <cobertura-instrument datafile="build/coverage/cobertura.ser">
            <fileset dir="build/classes">
                <include name="**/*.class" />
            </fileset>
        </cobertura-instrument>
    </target>
    
    <target name="cobertura-report">
        <cobertura-report datafile="build/coverage/cobertura.ser" destdir="build/coverage">
            <fileset dir="src">
                <include name="**/*.java" />
            </fileset>
        </cobertura-report>
    </target>
</project>